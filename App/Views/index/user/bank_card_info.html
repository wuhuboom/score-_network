<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{$title}</title>
    <link rel="stylesheet" href="/public/web/layui/css/layui.css">
    <link rel="stylesheet" href="/public/site/css/common.css">
</head>
<body style="background: #f1f1f1">
<div class="bill_header">
    <img src="/public/site/img/recharge_bg.png" style="max-height: 160px;width: 100%">
    <div class="" style="top: 0;background: none;padding:20px;border: none;position: absolute">
        <a  href="javascript:history.back(-1)" style="color: #ffffff;font-weight: bold"><i class="layui-icon layui-icon-left layui-font-20">&nbsp;&nbsp;{$title}</i></a>
    </div>
</div>

<div class="layui-margin-3"  style="position:relative;top: -80px" >
    <div class="layui-panel-window layui-font-16" style="border-radius: 8px;">
        <form class="layui-form" lay-filter="saveBankCardInfoForm">
            <input name="id" type="hidden" value="{$user_bank['id']??0}">
            <div class="demo-login-container">
                <div class="layui-form-item">
                    <div class="layui-input-wrap">
                        <div class="layui-input-prefix">
                            <i class="layui-icon layui-icon-list"></i>
                        </div>
                        <select name="bank_id" lay-verify="required">
                            {volist name="bank" id="v"}
                                <option value="{$v.id}" {if condition="$user_bank && $user_bank['bank_id']==$v['id']"} selected{/if}>{$v.bank_name}</option>
                            {/volist}
                        </select>

                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-wrap">
                        <div class="layui-input-prefix">
                            <i class="layui-icon layui-icon-password"></i>
                        </div>
                        <input type="text" name="card_holder_name"  value="{$user_bank['card_holder_name']??''}" lay-verify="required" placeholder="card holder name" lay-reqtext="card holder name" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-wrap">
                        <div class="layui-input-prefix">
                            <i class="layui-icon layui-icon-layer"></i>
                        </div>
                        <input type="text" name="card_number" value="{$user_bank['card_number']??''}" lay-verify="required" placeholder="card number" lay-reqtext="card number" autocomplete="off" class="layui-input">
                    </div>
                </div>


                <div class="layui-form-item">
                    {empty name="user_bank"}
                        <button class="layui-btn layui-bg-orange layui-btn-lg layui-btn-fluid layui-btn-radius" style="background: linear-gradient( 104deg, #FD7B0D 0%, #FEC46D 100%);"  lay-submit lay-filter="saveBankCardInfo">Add Bank Card</button>
                    {else/}
                        <button class="layui-btn layui-bg-orange layui-btn-lg layui-btn-fluid layui-btn-radius" style="background: linear-gradient( 104deg, #FD7B0D 0%, #FEC46D 100%);" lay-submit lay-filter="saveBankCardInfo">Edit Bank Card</button>
                    {/empty}

                </div>

            </div>
        </form>
    </div>
    <div class="layui-panel-window layui-font-16" style="border-radius: 8px;margin-top: 15px">
        <div class="demo-login-container">
            <h3 style="font-family: PingFang SC, PingFang SC;font-weight: 400;font-size: 16px;color: #3D3D3D;">Explain</h3>
            <div  style="margin-top: 20px;font-family: PingFang SC, PingFang SC;font-weight: 400;font-size: 13px;color: #3D3D3D;line-height: 20px;">
                <p style="margin-bottom:10px ">
                    1. You can only add one bank card for withdrawal purposes
                </p>
            </div>
        </div>
    </div>
</div>



<!-- body 末尾处引入 layui -->
<script src="/public/web/layui/layui.js"></script>


<script>
    layui.use(function(){
        var $ = layui.jquery;
        var layer = layui.layer;
        var form = layui.form;
        form.val('saveBankCardInfoForm', "{:json_encode($user_bank??[])}");

        // 提交事件
        form.on('submit(saveBankCardInfo)', function(data){
            var data = data.field; // 获取表单字段值
            $.post('/bankCardInfo',data,function (res) {
                if(res.status==1){
                    layer.msg(res.msg,{end:function () {
                            if(document.referrer){
                                window.location.href = document.referrer
                            }else{
                                window.location.href='/'
                            }
                        }});

                }else{
                    layer.msg(res.msg);
                }
            })
            return false; // 阻止默认 form 跳转
        });
    });
</script>
</body>
</html>
