<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{$title}</title>
    <link rel="stylesheet" href="/public/web/layui/css/layui.css">
    <link rel="stylesheet" href="/public/site/css/common.css">
</head>
<body style="background: #f1f1f1">
<div class="layui-panel layui-padding-3 layui-bg-blue" style="top: 0;background: linear-gradient( 270deg, #FD7B0D 0%, #FEC46D 100%);border: none;">
    <a  href="javascript:history.back(-1)" style="color: #ffffff;font-weight: bold">
        <i class="layui-icon layui-icon-left layui-font-20">&nbsp;&nbsp;{$title}</i></a>
</div>

<div class="layui-margin-3"  >

    <div class="layui-panel-window layui-font-16" style="border-radius: 20px;margin-bottom: 100px">
        <form class="layui-form" lay-filter="saveBankCardInfoForm">
            <input name="avatar" id="avatar" type="hidden" value="{$user['avatar']}">
            <div class="demo-login-container">
                <div class="user-header" style="margin-top: 10px;display: flex;justify-content: flex-start">

                    <div  >
                        <img src="{$user.avatar}" style="width: 60px;height: 60px" class="layui-circle" id="upload_avatar">
                    </div>
                    <div style="padding-left: 10px" >
                        <h1 class="layui-font-14" style="color: #000000;">{eq name="lang" value="Cn"}单击以更改头像{else/}Click to change avatar{/eq}</h1>
                        <p>{eq name="lang" value="Cn"}建议上传大于100px的1:1图像。{else/}Suggest uploading 1:1 images larger than 100px.{/eq}</p>
                    </div>
                    <div style="clear: both" ></div>
                </div>

                <div class="layui-form-item" style="margin-top: 20px">
                    <div class="layui-input-wrap">
                        <div class="layui-input-prefix">
                            <i class="layui-icon layui-icon-username"></i>
                        </div>
                        <input type="text" name="nickname"  value="{$user['nickname']??''}" lay-verify="required" placeholder="nickname" lay-reqtext="nickname" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-wrap">
                        <div class="layui-input-prefix">
                            <i class="layui-icon layui-icon-email"></i>
                        </div>
                        <input type="text" name="email"  value="{$user['email']??''}" lay-verify="required" placeholder="email" lay-reqtext="email" autocomplete="off" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <button class="layui-btn layui-bg-orange layui-btn-lg layui-btn-fluid layui-btn-radius"  lay-submit lay-filter="saveInfo">
                        {:l('SAVE_INFO',$lang)}</button>
                </div>

            </div>
        </form>
    </div>

</div>
<!--	底部内容-开始	  -->
{include file="index/common/page_service"}
<!--	底部内容-结束	  -->
<!-- body 末尾处引入 layui -->
<script src="/public/web/layui/layui.js"></script>


<script>
    layui.use(function(){
        var $ = layui.jquery;
        var layer = layui.layer;
        var form = layui.form;
        var upload = layui.upload;
        var element = layui.element;
        //常规使用 - 普通图片上传
        var uploadInst = upload.render({
            elem: '#upload_avatar'
            ,url: '/uploadPicture' // 实际使用时改成您自己的上传接口即可。
            ,data:{'directory':'avatar'}
            ,done: function(res){
                layer.msg(res.msg);
                //如果上传失败
                if(res.status = 1){
                    $('#avatar').val(res.result.path);
                    $('#upload_avatar').attr('src',res.result.show_path);
                }

            }
            ,error: function(){

            }
        });
        // 提交事件
        form.on('submit(saveInfo)', function(data){
            var data = data.field; // 获取表单字段值
            $.post('/info',data,function (res) {
                layer.msg(res.msg);
                if(res.status==1){
                    window.location.href = '/my'
                }
            })
            return false; // 阻止默认 form 跳转
        });

    });
</script>
</body>
</html>
