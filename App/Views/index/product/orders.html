<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{$title}</title>
    <link rel="stylesheet" href="/public/web/layui/css/layui.css">
    <link rel="stylesheet" href="/public/site/css/common.css">
    <style>
        .layui-layer-btn .layui-layer-btn0 {
            border-color: transparent;
            background-color: #FFC800 !important;
            color: #fff;
        }
        .product {
            font-family:Arial, Roboto, Helvetica, sans-serif;;
            background: #FFFFFF;
            border-radius: 8px 8px 8px 8px;
            margin-bottom: 10px;
            padding: 10px;
        }
        .product .product_title{
            font-family: Source Han Sans, Source Han Sans;
            font-weight: 900;
            font-size: 16px;
            color: #000000;
            line-height: 23px;
            padding-bottom: 10px;
            border-bottom: 1px solid #EAEAEA;
            display: flex;justify-content: space-between;
        }

        .product .product_title .product_status{
            font-family: PingFang SC, PingFang SC;
            font-weight: 400;
            font-size: 14px;
            color: #FE781F;
            line-height: 20px;
        }
        .product .product_title .product_status_finish{
            color: #666666;
        }
        .product .product_details{
            padding: 10px 0;
            display: flex;
            justify-content: start;
            border-bottom: 1px solid #EAEAEA;
        }
        .product .product_details img{
           width: 100px;
            height: 100px;
            border-radius: 4px 4px 4px 4px;

        }
        .product .product_info{
            padding-left: 10px;
            width: 100%;
        }
        .product .product_info p{
            font-family: PingFang SC, PingFang SC;
            font-weight: 400;
            font-size: 14px;
            color: #3D3D3D;
            line-height: 25px;
            height: 25px;
            display: flex;
            justify-content: space-between;
        }
        .product .product_info p .value{
            font-weight: 400;
            font-size: 14px;
            color: #333333;
        }
        .product .product_info p .price{
            font-weight: 400;
            font-size: 14px;
            color: #EB9000;
        }
        .product .product_footer{
            padding-top: 10px;
            text-align: right;
        }
        .product .product_footer a{
            height: 28px;
            line-height: 28px;
            width: 80px;
            background: #FFFFFF;
            color: #666666;
            border-radius: 100px 100px 100px 100px;
            border: 1px solid #DBDBDB;
        }
         .layui-tab {
            font-size: 16px;
            border-bottom: 1px solid #EAEAEA;
        }
         .layui-tab-title {
            font-size: 16px;
            border-bottom: 1px solid #EAEAEA;
             text-align: left;
        }
        .layui-tab .layui-tab-title li {
            text-align: center;
        }
         .layui-tab-title .layui-this{
            color: #FD7B0D;
            font-weight: bold;
        }
         .layui-tab-title .layui-this:after {
            color: #FD7B0D;
            font-weight: bold;
            border: none;

        }
        .product .img {width: 121px;height: 100%; min-height: 120px; max-height: 130px; border-radius: 10px 0 0 10px;}
        .product .right {padding: 10px 10px 10px 10px ;width: 100%}
        .product .right .item{display:flex;justify-content: space-between; font-size: 12px;}
        .product .right .item .label{color: #16baaa !important}
        .product .right .item .value{font-size:14px;color: #16baaa;font-weight: bold;line-height: 20px;}
    </style>
</head>
<body style="background: #ffffff">

<div>
    <div class="layui-tab" lay-filter="order" style="margin: 0px;">
        <ul class="layui-tab-title">
            {eq name="lang" value="Cn"}
                <li class="layui-this" lay-id="0">全部</li>
                <li lay-id="1">收益中</li>
                <li lay-id="2">已完成</li>
            {else/}
                <li class="layui-this" lay-id="0">All</li>
                <li lay-id="1">Normal</li>
                <li lay-id="2">Finish</li>
            {/eq}

        </ul>

    </div>
    <div id="order_list" style="padding: 20px;background: #F4F4F4">
<!--        <div class="product">-->
<!--            <div class="product_title">-->
<!--                <p>{$v['product_name']}<img src="/public/static/img/lv3.svg" style="width: 18px;height: 18px !important; display: inline"></p>-->
<!--                <span class="product_status">normal</span>-->
<!--            </div>-->
<!--            <div class="product_details" >-->
<!--               <img src="/public/site/img/product3x.png">-->
<!--                <div class="product_info">-->
<!--                    <p>-->
<!--                        <span>Price</span>-->
<!--                        <span class="value">{$system['currency']}{$v['price']}</span>-->
<!--                    </p>-->
<!--                    <p>-->
<!--                        <span>Days</span>-->
<!--                        <span class="value">{$v['revenue_days']}</span>-->
<!--                    </p>-->
<!--                    <p>-->
<!--                        <span>Daily Income</span>-->
<!--                        <span class="value">{$system['currency']}{:round($v['price']*$v['daily_yield'],2)}</span>-->
<!--                    </p>-->
<!--                    <p>-->
<!--                        <span>Total Income</span>-->
<!--                        <span class="price">{$system['currency']}{:round($v['price']*$v['daily_yield']*$v['revenue_days'],2)}</span>-->
<!--                    </p>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="product_footer">-->
<!--                <a class="layui-btn" > details </a>-->
<!--            </div>-->
<!--        </div>-->
    </div>
</div>

<!--	底部内容-开始	  -->
{include file="index/common/page_service"}
<!--	底部内容-结束	  -->

<!-- body 末尾处引入 layui -->
<script src="/public/web/layui/layui.js"></script>

<script>
    layui.use(function(){
        var $ = layui.jquery;
        var layer = layui.layer;
        var form = layui.form;
        var laydate = layui.laydate;
        var slider = layui.slider;
        var element = layui.element;
        var order_status='';
        var flow = layui.flow;
        var lang = '{$lang}'
        var buy_share = lang == 'Cn' ? "购买份数" : "Buy Share";
        var Days = lang == 'Cn' ? "天数" : "Days";
        var Daily_Income = lang == 'Cn' ? "每日收益" : "Daily Income";
        var Total_Income = lang == 'Cn' ? "总收益" : "Total Income";
            // 流加载实例
        flow.load({
            elem: '#order_list', // 流加载容器
            scrollElem: '#order_list', // 滚动条所在元素，一般不用填，此处只是演示需要。
            isAuto:true,
            end:'No more',
            done: function(page, next){ // 执行下一页的回调
                console.log(page)
                var lis = [];
                $.get('/getOrders?page='+page+'&status='+order_status,function (res) {
                    layui.each(res.result.list,function (index,item) {
                        var order_status = item.status==1?'<span class="product_status">normal</span>':'<span class="product_status product_status_finish">finish</span>';
                        var html ='     <div class="product">\n' +
                            '            <div class="product_title">\n' +
                            '                <p>'+item.name+' <img src="/public/static/img/lv'+item.level+'.svg" style="width: 18px;height: 18px !important; display: inline"></p>' +
                            '\n' +order_status+
                            '            </div>\n' +
                            '            <div class="product_details" >\n' +
                            '               <img src="'+item.image+'">\n' +
                            '                <div class="product_info">\n' +
                            '                    <p>\n' +
                            '                        <span>Buy Share</span>\n' +
                            '                        <span class="value">'+item.buy_share+'</span>\n' +
                            '                    </p>\n' +
                            '                    <p>\n' +
                            '                        <span>Days</span>\n' +
                            '                        <span class="value">'+item.revenue_days+'</span>\n' +
                            '                    </p>\n' +
                            '                    <p>\n' +
                            '                        <span>Daily Income</span>\n' +
                            '                        <span class="value">{$system[\'currency\']}'+item.daily_income+'</span>\n' +
                            '                    </p>\n' +
                            '                    <p>\n' +
                            '                        <span>Total Income</span>\n' +
                            '                        <span class="price">{$system[\'currency\']}'+item.generated_income+'</span>\n' +
                            '                    </p>\n' +
                            '                </div>\n' +
                            '            </div>\n' +
                            '            <div class="product_footer">\n' +
                            '<a href="/orders/'+item.id+'" class="layui-btn" > details </a>'+
                            '            </div>\n' +
                            '        </div>'
                        lis.push(html);
                    })

                    next(lis.join(''), page < res.result.page); // 此处假设总页数为 10

                })


                // 执行下一页渲染，第二参数为：满足“加载更多”的条件，即后面仍有分页
                // pages 为 Ajax返回的总页数，只有当前页小于总页数的情况下，才会继续出现加载更多
            }
        });
        element.on('tab(order)', function(data){
            order_status = this.getAttribute('lay-id')
            $('#order_list').html('')
            // 流加载实例
            flow.load({
                elem: '#order_list', // 流加载容器
                scrollElem: '#order_list', // 滚动条所在元素，一般不用填，此处只是演示需要。
                isAuto:true,
                end:'No more',
                done: function(page, next){ // 执行下一页的回调
                    console.log(page)
                    var lis = [];
                    $.get('/getOrders?page='+page+'&status='+order_status,function (res) {

                        layui.each(res.result.list,function (index,item) {
                            var order_status =  item.status==1?'<span class="product_status">normal</span>' : '<span class="product_status product_status_finish">finish</span>';
                            var html ='     <div class="product">\n' +
                                '            <div class="product_title">\n' +
                                '                <p>'+item.name+' <img src="/public/static/img/lv'+item.level+'.svg" style="width: 18px;height: 18px !important; display: inline"></p>\n' +
                                '\n' +order_status+
                                '            </div>\n' +
                                '            <div class="product_details" >\n' +
                                '               <img src="'+item.image+'">\n' +
                                '                <div class="product_info">\n' +
                                '                    <p>\n' +
                                '                        <span>Buy Share</span>\n' +
                                '                        <span class="value">'+item.buy_share+'</span>\n' +
                                '                    </p>\n' +
                                '                    <p>\n' +
                                '                        <span>Days</span>\n' +
                                '                        <span class="value">'+item.revenue_days+'</span>\n' +
                                '                    </p>\n' +
                                '                    <p>\n' +
                                '                        <span>Daily Income</span>\n' +
                                '                        <span class="value">{$system[\'currency\']}'+item.daily_income+'</span>\n' +
                                '                    </p>\n' +
                                '                    <p>\n' +
                                '                        <span>Total Income</span>\n' +
                                '                        <span class="price">{$system[\'currency\']}'+item.generated_income+'</span>\n' +
                                '                    </p>\n' +
                                '                </div>\n' +
                                '            </div>\n' +
                                '            <div class="product_footer">\n' +
                                '<a href="/orders/'+item.id+'" class="layui-btn" > details </a>'+
                                '            </div>\n' +
                                '        </div>'
                            lis.push(html);
                        })

                        next(lis.join(''), page < res.result.page); // 此处假设总页数为 10

                    })


                    // 执行下一页渲染，第二参数为：满足“加载更多”的条件，即后面仍有分页
                    // pages 为 Ajax返回的总页数，只有当前页小于总页数的情况下，才会继续出现加载更多
                }
            });
        });



    });
</script>
</body>
</html>
