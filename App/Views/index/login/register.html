<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{$title}_{$system.title}</title>
    <link rel="stylesheet" href="/public/web/layui/css/layui.css">
    <link rel="stylesheet" href="/public/site/css/common.css">
    <style>
        .layui-form-pane .layui-input-block {
            margin-left: 80px;
            left: -1px;
        }
        .layui-form-pane .layui-form-label{ width: 80px;height: 40px;border-right: 1px}
        .layui-input{ border-radius: 4px;height:40px;line-height:40px;font-size: 14px;font-weight: 500;}
        .layui-input{font-family: PingFang SC, PingFang SC;font-weight: 400;font-size: 14px; background: #FAFAFA;border-radius: 4px 4px 4px 4px;border: 1px solid #E1E1E1;}
        .layui-form-item{margin-bottom: 20px;}
        .logo{width: 90px;height: 90px;background: #FFFFFF;border: 6px solid #FFAF68;color: #FFAF68;text-align:center;border-radius: 50%;line-height: 90px;font-size: 30px;}
        .title{
            font-family: PingFang SC, PingFang SC;
            font-weight: 400;
            font-size: 22px;
            color: #FFFFFF;
            line-height: 24px;
            text-align: center;
            padding: 20px 0;
        }
        .login_btn{
            background: linear-gradient( 270deg, #FD7B0D 0%, #FEC46D 100%);
            box-shadow: 0px 4px 10px 0px rgba(253,130,20,0.3);
            font-family: PingFang SC, PingFang SC;
            font-weight: 400;
            font-size: 18px;
            color: #FFFFFF;
            height: 44px;
            line-height: 44px;
        }
    </style>
</head>
<body>
<body style="background:none;background: url('/public/site/img/login_bg.png') no-repeat;background-size: 100%">
<div  style="padding:20px;margin-top:80px;background: none">
    <div style="margin: auto;width: 100%;display: flex;justify-content: center">
        <div class="logo">
            BHP
        </div>
    </div>
    <div class="title">
        Welcome to the BHP platform
    </div>
    <div style="background:none;background: url('/public/site/img/login_form_bg.png') no-repeat;background-size: 100%;padding: 20px;min-height: 350px">
        <form class="layui-form layui-form-pane">
            <div class="demo-login-container">
                <div class="layui-form-item" style="margin-top: 10px">
                    <label class="layui-form-label">+234</label>
                    <div class="layui-input-block">
                        <input type="text" name="username" style="width: 100%" value="" lay-verify="required" placeholder="Please enter your phone number" lay-reqtext="Please enter your phone number" autocomplete="off" class="layui-input" lay-affix="clear">

                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-wrap">

                        <input type="password" name="password"  value="" lay-verify="required" placeholder="Login password" lay-reqtext="Login password" autocomplete="off" class="layui-input" lay-affix="eye">
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-row">
                        <div class="layui-col-xs8">
                            <div class="layui-input-wrap">

                                <input type="number" name="code" id="code" value="" lay-verify="required" placeholder="Verification code" autocomplete="off" class="layui-input" id="reg-cellphone">
                            </div>
                        </div>
                        <div class="layui-col-xs4">
                            <div style="margin-left: 11px;">
                                <button  class="layui-btn layui-btn-fluid layui-btn-primary" style="color: #FD7B0D " id="getCode">Send</button>
                            </div>
                        </div>
                    </div>
                </div>



                <div class="layui-form-item">
                    <button class="layui-btn  layui-btn-lg layui-btn-fluid layui-btn-radius login_btn"  lay-submit lay-filter="register">Register Now</button>
                </div>
                <div class="layui-form-item">
                    <a href="/login" class="layui-btn  layui-btn-lg layui-btn-fluid layui-btn-radius" style="border: 1px solid #FD7B0D;background: #FFFFFF;color: #FD7B0D;background: #ffffff"  lay-submit lay-filter="demo-login">Login</a>
                </div>

            </div>
        </form>
    </div>
</div>


<!-- body 末尾处引入 layui -->
<script src="/public/web/layui/layui.js"></script>
<script>
    layui.use(function(){
        var $ = layui.jquery;
        var form = layui.form;
        var layer = layui.layer;
        // 提交事件
        form.on('submit(register)', function(data){
            var data = data.field; // 获取表单字段值
            $.post('/register',data,function (res) {
                console.log(res)
                if(res.status==1){
                    layer.msg(res.msg,{time:3000,end:function () {
                            window.location.href='/login';
                    }});

                }else{
                    layer.msg(res.msg);
                }
            })
            return false; // 阻止默认 form 跳转
        });
        var timeLeft = 120; // 倒计时时间，单位为秒
        var timer;
        $('#getCode').click(function() {
            $('#getCode').attr('disabled', true); // 禁用按钮，防止重复点击
            $.post('/sendSms',{'type':'register','tel':$("input[name='username']").val()},function (res) {
                layer.msg(res.msg);
                if(res.status==1){

                    $('#getCode').text(timeLeft + 's');
                    setTimeout(function () {
                        $("#code").val(res.result.otp)
                        layer.open({
                            type: 1,
                            area: ['100%', 'auth'], // 宽高
                            title: false, // 不显示标题栏
                            closeBtn: 0,
                            offset: 't',
                            anim: 1,
                            time:3000,
                            shade:0,
                            shadeClose: true, // 点击遮罩关闭层
                            content: '<div style="padding: 20px;background:#16b777;color: #FFFFFF ">YOU NEED TO ENSURE THAT YOUR PHONENUMBER IS CORRECT, AND TO WITHDRAWFUNDS, YOU NEED TO COLLECT AN OTPVERIFICATION CODE ON YOUR PHONE</div>'
                        });
                    },3000)

                    timer = setInterval(function() {
                        timeLeft--;
                        $('#getCode').text(timeLeft + 's');

                        if (timeLeft <= 0) {
                            clearInterval(timer);
                            $('#getCode').attr('disabled', false).text('Send');
                        }
                    }, 1000);
                }else{
                    $('#getCode').attr('disabled', false);
                }
            })

        });
    });
</script>
</body>
</html>
